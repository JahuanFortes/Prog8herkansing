import "./style.css";
import {
  HandLandmarker,
  FilesetResolver,
  DrawingUtils,
} from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.18";
import jsonData from "../../preparing-data/src/data.json";

const enableWebcamButton = document.getElementById("webcamButton");
const logButton = document.getElementById("logButton");
const trainModelBtn = document.getElementById("trainModelBtn");
const video = document.getElementById("webcam");
const canvasElement = document.getElementById("output_canvas");
const canvasCtx = canvasElement.getContext("2d");
const drawUtils = new DrawingUtils(canvasCtx);

let handLandmarker = undefined;
let webcamRunning = false;
let results = undefined;
let image = document.querySelector("#myimage");
let isTrained = false;

ml5.setBackend("webgl");
const options = {
  inputs: 63,
  task: "classification",
  debug: true,
  layers: [
    {
      type: "dense",
      units: 32,
      activation: "relu",
    },
    {
      type: "dense",
      units: 32,
      activation: "relu",
    },
    {
      type: "dense",
      units: 32,
      activation: "relu",
    },
    {
      type: "dense",
      activation: "softmax",
    },
  ],
};
const nn = ml5.neuralNetwork(options);
const trainingOptions = {
  epochs: 50,
  learningRate: 0.2,
  hiddenUnits: 16,
};

trainModelBtn.addEventListener("click", (e) => startTraining(e));
// /********************************************************************
// // CREATE THE POSE DETECTOR
// ********************************************************************/
// const createHandLandmarker = async () => {
//   const vision = await FilesetResolver.forVisionTasks(
//     "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm"
//   );
//   handLandmarker = await HandLandmarker.createFromOptions(vision, {
//     baseOptions: {
//       modelAssetPath: `https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task`,
//       delegate: "GPU",
//     },
//     runningMode: "VIDEO",
//     numHands: 2,
//   });
//   console.log("model loaded, you can start webcam");

//   enableWebcamButton.addEventListener("click", (e) => enableCam(e));
//   logButton.addEventListener("click", (e) => logAllHands(e));
// };
// /********************************************************************
// // START THE WEBCAM
// ********************************************************************/
// async function enableCam() {
//   webcamRunning = true;
//   try {
//     const stream = await navigator.mediaDevices.getUserMedia({
//       video: true,
//       audio: false,
//     });
//     video.srcObject = stream;
//     video.addEventListener("loadeddata", () => {
//       canvasElement.style.width = video.videoWidth;
//       canvasElement.style.height = video.videoHeight;
//       canvasElement.width = video.videoWidth;
//       canvasElement.height = video.videoHeight;
//       document.querySelector(".videoView").style.height =
//         video.videoHeight + "px";
//       predictWebcam();
//     });
//   } catch (error) {
//     console.error("Error accessing webcam:", error);
//   }
// }

// /********************************************************************
// // START PREDICTIONS
// ********************************************************************/
// async function predictWebcam() {
//   results = await handLandmarker.detectForVideo(video, performance.now());

//   let hand = results.landmarks[0];

//   if (hand) {
//     let thumb = hand[4];
//     image.style.transform = `translate(${
//       video.videoWidth - thumb.x * video.videoWidth
//     }px, ${thumb.y * video.videoHeight}px)`;
//     // train();
//   }

//   canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
//   for (let hand of results.landmarks) {
//     drawUtils.drawConnectors(hand, HandLandmarker.HAND_CONNECTIONS, {
//       color: "#00FF00",
//       lineWidth: 5,
//     });
//     drawUtils.drawLandmarks(hand, {
//       radius: 4,
//       color: "#FF0000",
//       lineWidth: 2,
//     });
//   }

//   if (webcamRunning) {
//     window.requestAnimationFrame(predictWebcam);
//   }
// }
// /********************************************************************
// // LOG HAND COORDINATES IN THE CONSOLE
// ********************************************************************/
// function logAllHands() {
//   const hand = results.landmarks;
//   hand.forEach((hand) => {
//     const mdArr = hand
//       .map((landmark) => [landmark.x, landmark.y, landmark.z])
//       .flat();
//     console.log(mdArr);
//   });

//   // console.log(mdArr);
// }

let data = [
  {
    points: [
      0.6020334959030151, 0.7299489974975586, 3.5855117630489985e-7,
      0.5299228429794312, 0.6996667385101318, -0.014823118224740028,
      0.46855929493904114, 0.6219339370727539, -0.018458712846040726,
      0.433351993560791, 0.5583590865135193, -0.023020751774311066,
      0.3956678509712219, 0.5200864672660828, -0.02829867973923683,
      0.49135488271713257, 0.4653908610343933, -0.0006772872875444591,
      0.45420584082603455, 0.37280064821243286, -0.014991561882197857,
      0.4364430904388428, 0.3123999536037445, -0.029898900538682938,
      0.42616578936576843, 0.2617284655570984, -0.04211113229393959,
      0.5361603498458862, 0.4379010796546936, -0.0100575415417552,
      0.5118898153305054, 0.31703054904937744, -0.020353712141513824,
      0.5016949772834778, 0.2429073005914688, -0.03475572168827057,
      0.49626779556274414, 0.1838764250278473, -0.046462614089250565,
      0.5850368738174438, 0.4380597472190857, -0.02361030876636505,
      0.5743252038955688, 0.32144278287887573, -0.04008979722857475,
      0.568962574005127, 0.2487354874610901, -0.057495731860399246,
      0.564927875995636, 0.18675890564918518, -0.07136432826519012,
      0.6363912224769592, 0.463008314371109, -0.03888260945677757,
      0.6587003469467163, 0.38480740785598755, -0.05704654008150101,
      0.6752586364746094, 0.33073562383651733, -0.06788314133882523,
      0.6901972889900208, 0.2810794711112976, -0.07619307190179825,
    ],
    label: "A",
  },
  {
    points: [
      0.23463210463523865, 0.56447833776474, 7.665987027394294e-7,
      0.28733086585998535, 0.45102331042289734, 0.012170794419944286,
      0.36997437477111816, 0.38556697964668274, 0.00664243008941412,
      0.441214919090271, 0.37972551584243774, -0.0045096795074641705,
      0.492579847574234, 0.40366461873054504, -0.014269205741584301,
      0.42500367760658264, 0.335985004901886, -0.016909390687942505,
      0.521612286567688, 0.2848019599914551, -0.031712740659713745,
      0.5745861530303955, 0.24277570843696594, -0.03925176337361336,
      0.6167481541633606, 0.2059624195098877, -0.045020490884780884,
      0.4450426697731018, 0.40289604663848877, -0.03427661955356598,
      0.5548915863037109, 0.43217960000038147, -0.047614894807338715,
      0.6168660521507263, 0.45885252952575684, -0.05216272175312042,
      0.6635483503341675, 0.47735539078712463, -0.055367570370435715,
      0.44851765036582947, 0.48418402671813965, -0.04828638583421707,
      0.5042881965637207, 0.5347515344619751, -0.05371936410665512,
      0.46729761362075806, 0.5502527952194214, -0.03827504441142082,
      0.4307330548763275, 0.5525416731834412, -0.026600243523716927,
      0.44118526577949524, 0.5664853453636169, -0.06299816817045212,
      0.4759625792503357, 0.6042198538780212, -0.05832824110984802,
      0.4493972361087799, 0.6136027574539185, -0.0386107936501503,
      0.4239581525325775, 0.6119392514228821, -0.022494982928037643,
    ],
    label: "B",
  },
  {
    points: [
      0.6977053880691528, 0.766216516494751, -6.665582645837276e-7,
      0.6193670034408569, 0.7404953837394714, -0.01366600301116705,
      0.5476810932159424, 0.6657430529594421, -0.019437776878476143,
      0.5392820239067078, 0.5804466009140015, -0.03073226287961006,
      0.5826443433761597, 0.529209315776825, -0.03651486709713936,
      0.5685168504714966, 0.550809919834137, 0.023585224524140358,
      0.5389684438705444, 0.5015928149223328, -0.015452762134373188,
      0.5522809028625488, 0.5725553631782532, -0.033331189304590225,
      0.5664838552474976, 0.593934953212738, -0.03874560445547104,
      0.6104726195335388, 0.5301405191421509, 0.012637262232601643,
      0.57962566614151, 0.48033222556114197, -0.028588151559233665,
      0.5946328639984131, 0.5701560378074646, -0.03242156654596329,
      0.6111725568771362, 0.5836236476898193, -0.020542319864034653,
      0.6592447757720947, 0.5212739109992981, -0.007304056081920862,
      0.6267918348312378, 0.48178163170814514, -0.04916295409202576,
      0.6386250853538513, 0.5738889575004578, -0.03424081206321716,
      0.65324866771698, 0.5863460898399353, -0.009540212340652943,
      0.7161409854888916, 0.5231482982635498, -0.02943279966711998,
      0.6777361631393433, 0.4951697289943695, -0.047733552753925323,
      0.6809157729148865, 0.5600003004074097, -0.03136033937335014,
      0.6951660513877869, 0.5727018117904663, -0.011489404365420341,
    ],
    label: "C",
  },
  {
    points: [
      0.5153821110725403, 0.47224462032318115, -0.08003219962120056,
      0.6553313732147217, 0.5267695188522339, -0.11657813936471939,
      0.6279545426368713, 0.5542050004005432, -0.12706144154071808,
      0.5825455784797668, 0.5452958345413208, -0.1309441328048706,
      0.5205761194229126, 0.5640887022018433, -0.08580771833658218,
      0.6644919514656067, 0.6062707901000977, -0.11211303621530533,
      0.6298732757568359, 0.6236384510993958, -0.10590071231126785,
      0.5819289088249207, 0.6129541397094727, -0.10405641794204712,
      0.5280868411064148, 0.6612586379051208, -0.09168031811714172,
      0.660127580165863, 0.6862475872039795, -0.11143356561660767,
      0.6245784759521484, 0.6993106603622437, -0.09114643186330795,
      0.5804917812347412, 0.6886382102966309, -0.08017780631780624,
      0.5390264391899109, 0.7533453702926636, -0.09871771186590195,
      0.6425935626029968, 0.7600482702255249, -0.10920100659132004,
      0.6085034012794495, 0.7682472467422485, -0.09303925931453705,
      0.5643256902694702, 0.7596419453620911, -0.08308982849121094,
    ],
    label: "D",
  },
  {
    points: [
      0.48498305678367615, 0.7086589932441711, -2.613631977510522e-7,
      0.4192971885204315, 0.6015051007270813, -0.0524817518889904,
      0.4303460121154785, 0.45395609736442566, -0.07881392538547516,
      0.49482470750808716, 0.35132044553756714, -0.10489045083522797,
      0.5349677205085754, 0.25447455048561096, -0.12775307893753052,
      0.569325864315033, 0.3261090815067291, -0.04484870657324791,
      0.6720404624938965, 0.2110837996006012, -0.10306436568498611,
      0.7517101764678955, 0.1526273488998413, -0.14031654596328735,
      0.8185968995094299, 0.10755866765975952, -0.1642017662525177,
      0.6242204308509827, 0.39263615012168884, -0.048245228826999664,
      0.6313121914863586, 0.38369303941726685, -0.14287307858467102,
      0.5505669713020325, 0.4727804660797119, -0.1669774353504181,
      0.5047841668128967, 0.5189286470413208, -0.16171827912330627,
      0.6608633399009705, 0.4671006500720978, -0.05982262268662453,
      0.6477382779121399, 0.4775300621986389, -0.14448003470897675,
      0.5605083107948303, 0.5472666621208191, -0.13388873636722565,
      0.5181490182876587, 0.5629661083221436, -0.10562088340520859,
      0.6876029372215271, 0.550150454044342, -0.07669566571712494,
      0.6644377708435059, 0.5651057958602905, -0.13133220374584198,
      0.5875408053398132, 0.599624752998352, -0.12380871921777725,
      0.5465890765190125, 0.5926768779754639, -0.10328350216150284,
    ],
    label: "LEFT",
  },
  {
    points: [
      0.6059243679046631, 0.39672034978866577, 0.03732666000723839,
      0.523444652557373, 0.35996827483177185, 0.0523562878370285,
      0.46732640266418457, 0.37853652238845825, 0.06519021838903427,
      0.51715487241745, 0.3736554980278015, -0.008775011636316776,
      0.3970975875854492, 0.34792599081993103, -0.0028161215595901012,
      0.32641467452049255, 0.3524332642555237, -0.0024198931641876698,
      0.2720555365085602, 0.35521572828292847, -0.004410699941217899,
      0.4869975745677948, 0.4505748450756073, -0.013050413690507412,
      0.42637255787849426, 0.46881940960884094, 0.014418852515518665,
      0.4610101282596588, 0.48968806862831116, 0.031914759427309036,
      0.49950647354125977, 0.49335718154907227, 0.034419696778059006,
      0.47410547733306885, 0.5355952978134155, -0.0127952815964818,
      0.439791202545166, 0.5420079231262207, 0.019668396562337875,
      0.4735857844352722, 0.5549121499061584, 0.03472894802689552,
      0.5052120089530945, 0.5586672425270081, 0.031914759427309036,
      0.46799635887145996, 0.6162353754043579, -0.011295411735773087,
      0.45568621158599854, 0.6089770197868347, 0.01946738362312317,
      0.4889565706253052, 0.6146349906921387, 0.03664630651473999,
      0.5172717571258545, 0.6194503307342529, 0.04224375635385513,
    ],
    label: "RIGHT",
  },
  {
    points: [
      0.2549920082092285, 0.7104541063308716, 2.3084298561570904e-7,
      0.3217724859714508, 0.6520946025848389, -0.03515414893627167,
      0.3721734285354614, 0.5555192828178406, -0.0604557991027832,
      0.3638404309749603, 0.4681176245212555, -0.08674853295087814,
      0.3304360508918762, 0.39761438965797424, -0.11082592606544495,
      0.3255774974822998, 0.38126975297927856, -0.023100879043340683,
      0.3504208028316498, 0.27139946818351746, -0.05748256668448448,
      0.36514076590538025, 0.1948460340499878, -0.0729900375008583,
      0.37080055475234985, 0.12839540839195251, -0.08278422802686691,
      0.2690964341163635, 0.3861411511898041, -0.03127728030085564,
      0.3251875042915344, 0.2999972701072693, -0.08534936606884003,
      0.3410060405731201, 0.41168278455734253, -0.09304480254650116,
      0.32593613862991333, 0.45506352186203003, -0.08290082216262817,
      0.2193019986152649, 0.40825366973876953, -0.044715140014886856,
      0.2791573405265808, 0.37051278352737427, -0.10849397629499435,
      0.29293888807296753, 0.4817831814289093, -0.09654272347688675,
      0.2677397131919861, 0.5096362233161926, -0.07124107331037521,
      0.16909542679786682, 0.44752779603004456, -0.059814516454935074,
      0.22522658109664917, 0.4094836413860321, -0.10027384757995605,
      0.24421751499176025, 0.48454511165618896, -0.0841250941157341,
      0.2217048704624176, 0.5108723640441895, -0.062379661947488785,
    ],
    label: "UP",
  },
  {
    points: [
      0.6984677910804749, 0.22133710980415344, 4.468483325581474e-7,
      0.594536304473877, 0.2599785625934601, -0.013655438087880611,
      0.5182557702064514, 0.3467506766319275, -0.026610957458615303,
      0.5065767765045166, 0.4562761187553406, -0.03090846538543701,
      0.5200420618057251, 0.5206822752952576, -0.03533196076750755,
      0.5709550976753235, 0.43022218346595764, -0.08147069066762924,
      0.5245792865753174, 0.5918886065483093, -0.0995006263256073,
      0.5006288290023804, 0.6842368245124817, -0.10487601161003113,
      0.4891318380832672, 0.7611638903617859, -0.10823561996221542,
      0.6339957118034363, 0.4835602641105652, -0.07245571166276932,
      0.5565657019615173, 0.5978230237960815, -0.0761512964963913,
      0.5295867323875427, 0.5633726119995117, -0.05901724845170975,
      0.5339434742927551, 0.5166435241699219, -0.04907838627696037,
      0.6824436187744141, 0.5073114037513733, -0.058233339339494705,
      0.605813205242157, 0.5961959958076477, -0.05254998803138733,
      0.5832516551017761, 0.562235951423645, -0.029984571039676666,
      0.5889005064964294, 0.5178597569465637, -0.01958375982940197,
      0.7168518304824829, 0.5163636803627014, -0.0442909337580204,
      0.6498807668685913, 0.5755624771118164, -0.03804764896631241,
      0.6269984245300293, 0.5495324730873108, -0.022201459854841232,
      0.629580557346344, 0.5186541080474854, -0.012206603772938251,
    ],
    label: "DOWN",
  },
];

// function setup() {
//   for (let i = 0; i < data.length; i++) {
//     const landmark = data[i];
//     let inputs = [landmark.x, landmark.y, landmark.z];
//   }
// }

const trainingData = [
  //A
  nn.addData(
    [
      0.6020334959030151, 0.7299489974975586, 3.5855117630489985e-7,
      0.5299228429794312, 0.6996667385101318, -0.014823118224740028,
      0.46855929493904114, 0.6219339370727539, -0.018458712846040726,
      0.433351993560791, 0.5583590865135193, -0.023020751774311066,
      0.3956678509712219, 0.5200864672660828, -0.02829867973923683,
      0.49135488271713257, 0.4653908610343933, -0.0006772872875444591,
      0.45420584082603455, 0.37280064821243286, -0.014991561882197857,
      0.4364430904388428, 0.3123999536037445, -0.029898900538682938,
      0.42616578936576843, 0.2617284655570984, -0.04211113229393959,
      0.5361603498458862, 0.4379010796546936, -0.0100575415417552,
      0.5118898153305054, 0.31703054904937744, -0.020353712141513824,
      0.5016949772834778, 0.2429073005914688, -0.03475572168827057,
      0.49626779556274414, 0.1838764250278473, -0.046462614089250565,
      0.5850368738174438, 0.4380597472190857, -0.02361030876636505,
      0.5743252038955688, 0.32144278287887573, -0.04008979722857475,
      0.568962574005127, 0.2487354874610901, -0.057495731860399246,
      0.564927875995636, 0.18675890564918518, -0.07136432826519012,
      0.6363912224769592, 0.463008314371109, -0.03888260945677757,
      0.6587003469467163, 0.38480740785598755, -0.05704654008150101,
      0.6752586364746094, 0.33073562383651733, -0.06788314133882523,
      0.6901972889900208, 0.2810794711112976, -0.07619307190179825,
    ],
    { label: "A" }
  ),
  //B
  nn.addData(
    [
      0.23463210463523865, 0.56447833776474, 7.665987027394294e-7,
      0.28733086585998535, 0.45102331042289734, 0.012170794419944286,
      0.36997437477111816, 0.38556697964668274, 0.00664243008941412,
      0.441214919090271, 0.37972551584243774, -0.0045096795074641705,
      0.492579847574234, 0.40366461873054504, -0.014269205741584301,
      0.42500367760658264, 0.335985004901886, -0.016909390687942505,
      0.521612286567688, 0.2848019599914551, -0.031712740659713745,
      0.5745861530303955, 0.24277570843696594, -0.03925176337361336,
      0.6167481541633606, 0.2059624195098877, -0.045020490884780884,
      0.4450426697731018, 0.40289604663848877, -0.03427661955356598,
      0.5548915863037109, 0.43217960000038147, -0.047614894807338715,
      0.6168660521507263, 0.45885252952575684, -0.05216272175312042,
      0.6635483503341675, 0.47735539078712463, -0.055367570370435715,
      0.44851765036582947, 0.48418402671813965, -0.04828638583421707,
      0.5042881965637207, 0.5347515344619751, -0.05371936410665512,
      0.46729761362075806, 0.5502527952194214, -0.03827504441142082,
      0.4307330548763275, 0.5525416731834412, -0.026600243523716927,
      0.44118526577949524, 0.5664853453636169, -0.06299816817045212,
      0.4759625792503357, 0.6042198538780212, -0.05832824110984802,
      0.4493972361087799, 0.6136027574539185, -0.0386107936501503,
      0.4239581525325775, 0.6119392514228821, -0.022494982928037643,
    ],
    { label: "B" }
  ),
  //C
  nn.addData(
    [
      0.6977053880691528, 0.766216516494751, -6.665582645837276e-7,
      0.6193670034408569, 0.7404953837394714, -0.01366600301116705,
      0.5476810932159424, 0.6657430529594421, -0.019437776878476143,
      0.5392820239067078, 0.5804466009140015, -0.03073226287961006,
      0.5826443433761597, 0.529209315776825, -0.03651486709713936,
      0.5685168504714966, 0.550809919834137, 0.023585224524140358,
      0.5389684438705444, 0.5015928149223328, -0.015452762134373188,
      0.5522809028625488, 0.5725553631782532, -0.033331189304590225,
      0.5664838552474976, 0.593934953212738, -0.03874560445547104,
      0.6104726195335388, 0.5301405191421509, 0.012637262232601643,
      0.57962566614151, 0.48033222556114197, -0.028588151559233665,
      0.5946328639984131, 0.5701560378074646, -0.03242156654596329,
      0.6111725568771362, 0.5836236476898193, -0.020542319864034653,
      0.6592447757720947, 0.5212739109992981, -0.007304056081920862,
      0.6267918348312378, 0.48178163170814514, -0.04916295409202576,
      0.6386250853538513, 0.5738889575004578, -0.03424081206321716,
      0.65324866771698, 0.5863460898399353, -0.009540212340652943,
      0.7161409854888916, 0.5231482982635498, -0.02943279966711998,
      0.6777361631393433, 0.4951697289943695, -0.047733552753925323,
      0.6809157729148865, 0.5600003004074097, -0.03136033937335014,
      0.6951660513877869, 0.5727018117904663, -0.011489404365420341,
    ],
    { label: "C" }
  ),
  //D
  nn.addData(
    [
      0.5153821110725403, 0.47224462032318115, -0.08003219962120056,
      0.6553313732147217, 0.5267695188522339, -0.11657813936471939,
      0.6279545426368713, 0.5542050004005432, -0.12706144154071808,
      0.5825455784797668, 0.5452958345413208, -0.1309441328048706,
      0.5205761194229126, 0.5640887022018433, -0.08580771833658218,
      0.6644919514656067, 0.6062707901000977, -0.11211303621530533,
      0.6298732757568359, 0.6236384510993958, -0.10590071231126785,
      0.5819289088249207, 0.6129541397094727, -0.10405641794204712,
      0.5280868411064148, 0.6612586379051208, -0.09168031811714172,
      0.660127580165863, 0.6862475872039795, -0.11143356561660767,
      0.6245784759521484, 0.6993106603622437, -0.09114643186330795,
      0.5804917812347412, 0.6886382102966309, -0.08017780631780624,
      0.5390264391899109, 0.7533453702926636, -0.09871771186590195,
      0.6425935626029968, 0.7600482702255249, -0.10920100659132004,
      0.6085034012794495, 0.7682472467422485, -0.09303925931453705,
      0.5643256902694702, 0.7596419453620911, -0.08308982849121094,
    ],
    { label: "D" }
  ),
  //left
  nn.addData(
    [
      0.48498305678367615, 0.7086589932441711, -2.613631977510522e-7,
      0.4192971885204315, 0.6015051007270813, -0.0524817518889904,
      0.4303460121154785, 0.45395609736442566, -0.07881392538547516,
      0.49482470750808716, 0.35132044553756714, -0.10489045083522797,
      0.5349677205085754, 0.25447455048561096, -0.12775307893753052,
      0.569325864315033, 0.3261090815067291, -0.04484870657324791,
      0.6720404624938965, 0.2110837996006012, -0.10306436568498611,
      0.7517101764678955, 0.1526273488998413, -0.14031654596328735,
      0.8185968995094299, 0.10755866765975952, -0.1642017662525177,
      0.6242204308509827, 0.39263615012168884, -0.048245228826999664,
      0.6313121914863586, 0.38369303941726685, -0.14287307858467102,
      0.5505669713020325, 0.4727804660797119, -0.1669774353504181,
      0.5047841668128967, 0.5189286470413208, -0.16171827912330627,
      0.6608633399009705, 0.4671006500720978, -0.05982262268662453,
      0.6477382779121399, 0.4775300621986389, -0.14448003470897675,
      0.5605083107948303, 0.5472666621208191, -0.13388873636722565,
      0.5181490182876587, 0.5629661083221436, -0.10562088340520859,
      0.6876029372215271, 0.550150454044342, -0.07669566571712494,
      0.6644377708435059, 0.5651057958602905, -0.13133220374584198,
      0.5875408053398132, 0.599624752998352, -0.12380871921777725,
      0.5465890765190125, 0.5926768779754639, -0.10328350216150284,
    ],
    { label: "LEFT" }
  ),
  //right
  nn.addData(
    [
      0.6059243679046631, 0.39672034978866577, 0.03732666000723839,
      0.523444652557373, 0.35996827483177185, 0.0523562878370285,
      0.46732640266418457, 0.37853652238845825, 0.06519021838903427,
      0.51715487241745, 0.3736554980278015, -0.008775011636316776,
      0.3970975875854492, 0.34792599081993103, -0.0028161215595901012,
      0.32641467452049255, 0.3524332642555237, -0.0024198931641876698,
      0.2720555365085602, 0.35521572828292847, -0.004410699941217899,
      0.4869975745677948, 0.4505748450756073, -0.013050413690507412,
      0.42637255787849426, 0.46881940960884094, 0.014418852515518665,
      0.4610101282596588, 0.48968806862831116, 0.031914759427309036,
      0.49950647354125977, 0.49335718154907227, 0.034419696778059006,
      0.47410547733306885, 0.5355952978134155, -0.0127952815964818,
      0.439791202545166, 0.5420079231262207, 0.019668396562337875,
      0.4735857844352722, 0.5549121499061584, 0.03472894802689552,
      0.5052120089530945, 0.5586672425270081, 0.031914759427309036,
      0.46799635887145996, 0.6162353754043579, -0.011295411735773087,
      0.45568621158599854, 0.6089770197868347, 0.01946738362312317,
      0.4889565706253052, 0.6146349906921387, 0.03664630651473999,
      0.5172717571258545, 0.6194503307342529, 0.04224375635385513,
    ],
    { label: "RIGHT" }
  ),
  //up
  nn.addData(
    [
      0.2549920082092285, 0.7104541063308716, 2.3084298561570904e-7,
      0.3217724859714508, 0.6520946025848389, -0.03515414893627167,
      0.3721734285354614, 0.5555192828178406, -0.0604557991027832,
      0.3638404309749603, 0.4681176245212555, -0.08674853295087814,
      0.3304360508918762, 0.39761438965797424, -0.11082592606544495,
      0.3255774974822998, 0.38126975297927856, -0.023100879043340683,
      0.3504208028316498, 0.27139946818351746, -0.05748256668448448,
      0.36514076590538025, 0.1948460340499878, -0.0729900375008583,
      0.37080055475234985, 0.12839540839195251, -0.08278422802686691,
      0.2690964341163635, 0.3861411511898041, -0.03127728030085564,
      0.3251875042915344, 0.2999972701072693, -0.08534936606884003,
      0.3410060405731201, 0.41168278455734253, -0.09304480254650116,
      0.32593613862991333, 0.45506352186203003, -0.08290082216262817,
      0.2193019986152649, 0.40825366973876953, -0.044715140014886856,
      0.2791573405265808, 0.37051278352737427, -0.10849397629499435,
      0.29293888807296753, 0.4817831814289093, -0.09654272347688675,
      0.2677397131919861, 0.5096362233161926, -0.07124107331037521,
      0.16909542679786682, 0.44752779603004456, -0.059814516454935074,
      0.22522658109664917, 0.4094836413860321, -0.10027384757995605,
      0.24421751499176025, 0.48454511165618896, -0.0841250941157341,
      0.2217048704624176, 0.5108723640441895, -0.062379661947488785,
    ],
    { label: "UP" }
  ),
  //down
  nn.addData(
    [
      0.6984677910804749, 0.22133710980415344, 4.468483325581474e-7,
      0.594536304473877, 0.2599785625934601, -0.013655438087880611,
      0.5182557702064514, 0.3467506766319275, -0.026610957458615303,
      0.5065767765045166, 0.4562761187553406, -0.03090846538543701,
      0.5200420618057251, 0.5206822752952576, -0.03533196076750755,
      0.5709550976753235, 0.43022218346595764, -0.08147069066762924,
      0.5245792865753174, 0.5918886065483093, -0.0995006263256073,
      0.5006288290023804, 0.6842368245124817, -0.10487601161003113,
      0.4891318380832672, 0.7611638903617859, -0.10823561996221542,
      0.6339957118034363, 0.4835602641105652, -0.07245571166276932,
      0.5565657019615173, 0.5978230237960815, -0.0761512964963913,
      0.5295867323875427, 0.5633726119995117, -0.05901724845170975,
      0.5339434742927551, 0.5166435241699219, -0.04907838627696037,
      0.6824436187744141, 0.5073114037513733, -0.058233339339494705,
      0.605813205242157, 0.5961959958076477, -0.05254998803138733,
      0.5832516551017761, 0.562235951423645, -0.029984571039676666,
      0.5889005064964294, 0.5178597569465637, -0.01958375982940197,
      0.7168518304824829, 0.5163636803627014, -0.0442909337580204,
      0.6498807668685913, 0.5755624771118164, -0.03804764896631241,
      0.6269984245300293, 0.5495324730873108, -0.022201459854841232,
      0.629580557346344, 0.5186541080474854, -0.012206603772938251,
    ],
    { label: "DOWN" }
  ),
];

function startTraining() {
  if (Array.isArray(jsonData)) {
    console.log(jsonData);

    const randomData = [...jsonData].sort(() => Math.random() - 0.5);
    for (let pose of randomData) {
      nn.addData(pose.points, { label: pose.label });
    }
    let normal = nn.normalizeData();
    console.log(normal);

    nn.train(trainingOptions, () => finishedTraining());
  } else {
    console.error("No array :) ");
  }
}

async function finishedTraining() {
  nn.save("model", () => console.log("yay!"));
}
// function train() {
//   if (Array.isArray(jsonData)) {
//     for (let pose of jsonData) {
//       knn.learn(pose.points, pose.label);
//       console.log(pose);
//     }
//   }
// }

/********************************************************************
// START THE APP
********************************************************************/

// if (navigator.mediaDevices?.getUserMedia) {
//   createHandLandmarker();
// }
